version: '3.8'

services: 
    # Backend
    recipe-search-server:
        container_name: backend
        build: ./
        command: npm start
        working_dir: /recipeSearchServer
        environment:
            POSTGRES_URI: postgres://postgres:fibonachi0%0@postgres:5432/scraper
        depends_on:
            - postgres
        ports:
            - "5000:5000"
        volumes:
            - .:/recipeSearchServer:consistent
    
    # Postgres
    postgres:
        ports:
            - "5432:5432"
        environment:
            POSTGRES_USER: postgres
            POSTGRES_PASSWORD: fibonachi0%0
            POSTGRES_DB: scraper
            HOST: postgres
        build:
            context: .
            dockerfile: Dockerfile.db
